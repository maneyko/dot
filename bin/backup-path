#!/bin/bash

cp -v "$f" "$f_dest"

f="$1"

if test ! -f "$f"; then
  echo "'$f' is not a valid file!"
  exit 1
fi

ext="${f##*.}"
fbase="${f%.*}"
num="01"

test -n "$(echo "$fbase" | perl -ne 'print if /[^a-zA-Z][\d]+$/')" && {
  num="${fbase##*.}"
  fbase="${fbase%.*}"
}

f_dest="${fbase}.$num.$ext"

while test -f "$f_dest"; do
  num=$(echo "$num + 1" | bc)
  f_dest=$(printf "${fbase}.%02d.${ext}" $num)
done

echo "$f_dest"
cp "$f" "$f_dest"
