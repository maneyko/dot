# session configuration
# =========================================================================

if-shell "which reattach-to-user-namespace 2>/dev/null" \
           "set -g default-command 'reattach-to-user-namespace -l ${SHELL}'" \
           "set -g default-command '${SHELL}'"

if-shell "test $is_maneyko" \
           "set -g prefix 'M-a'" \
           "set -g prefix 'M-s'"

set -g default-terminal "screen-256color"
source-file $HOME/.tmux/unbind_tmux.conf

# functions
# =========================================================================
# M-s to create 4 splits
bind-key    'M-n'     new-window \; split-window -v \; split-window -h \;\
                      select-pane -U \; split-window -h \; select-pane -L \;\
                      resize-pane -D 12 \; select-pane -D \; swap-pane -U \;\
                      select-pane -D \; swap-pane -U \; resize-pane -R 25 \;\
                      select-pane -U \; select-pane -L

bind-key     'n'      new-window \; split-window -h\; select-pane -L

# key-bindings
# =========================================================================

bind-key -n 'M-0'     select-window -t :=0
bind-key -n 'M-1'     select-window -t :=1
bind-key -n 'M-2'     select-window -t :=2
bind-key -n 'M-3'     select-window -t :=3
bind-key -n 'M-4'     select-window -t :=4
bind-key -n 'M-5'     select-window -t :=5
bind-key -n 'M-6'     select-window -t :=6
bind-key -n 'M-7'     select-window -t :=7
bind-key -n 'M-8'     select-window -t :=8
bind-key -n 'M-9'     select-window -t :=9
bind-key -n 'M-h'     select-pane -L
bind-key -n 'M-j'     select-pane -D
bind-key -n 'M-k'     select-pane -U
bind-key -n 'M-l'     select-pane -R
bind-key -n 'M-x'     kill-pane
bind-key -n 'M-['     copy-mode
bind-key -n 'M-]'     run-shell "reattach-to-user-namespace pbpaste | \
                                 tmux load-buffer - && tmux paste-buffer"

bind-key -r   h       resize-pane -L
bind-key -r   j       resize-pane -D
bind-key -r   k       resize-pane -U
bind-key -r   l       resize-pane -R
bind-key -r  Down     select-pane -D
bind-key -r  Left     select-pane -L
bind-key -r  Right    select-pane -R
bind-key -r  Up       select-pane -U

bind-key      0       select-window -t :=0
bind-key      1       select-window -t :=1
bind-key      2       select-window -t :=2
bind-key      3       select-window -t :=3
bind-key      4       select-window -t :=4
bind-key      5       select-window -t :=5
bind-key      6       select-window -t :=6
bind-key      7       select-window -t :=7
bind-key      8       select-window -t :=8
bind-key      9       select-window -t :=9
bind-key      :       command-prompt
bind-key      b       split-window -v -c "#{pane_current_path}"
bind-key      c       new-window -c      "#{pane_current_path}"
bind-key      e       run-shell "pwd"
bind-key      p       previous-window
bind-key      q       kill-window
bind-key      r       source-file ~/.tmux.conf \; display "Config Reloaded!"
bind-key      s       setw synchronize-panes \; display "Toggle Sync"
bind-key      v       split-window -h -c "#{pane_current_path}"
bind-key      w       list-windows
bind-key      x       kill-pane
bind-key      {       swap-pane -U
bind-key      }       swap-pane -D
bind-key    'M-q'     confirm-before -p "kill-server? (y/n)"\
                                      kill-server

bind-key -t vi-copy i     halfpage-up
bind-key -t vi-copy o     scroll-down
bind-key -t vi-copy p     scroll-up
bind-key -t vi-copy u     halfpage-down
bind-key -t vi-copy v     begin-selection
bind-key -t vi-copy y     copy-pipe "reattach-to-user-namespace pbcopy"
bind-key -t vi-copy Enter copy-pipe "reattach-to-user-namespace pbcopy"
bind-key -t vi-copy Down  scroll-down
bind-key -t vi-copy Up    scroll-up


# preferences
# =========================================================================

# colors
tm_color_inactive='fg=colour19'
tm_color_active='fg=colour183'

set -g renumber-windows on      # renumber windows when a window is closed
set -g base-index 1             # start renumbering at 1
set -g repeat-time 750          # default is 500ms
if-shell "test `tmux -V | tr -cd '[:digit:]'` -ge 21" \
           "set -g mouse on" \
           "set -g mouse-select-pane on"
setw -g mode-keys vi            # vi bindings in copy mode
set -s escape-time 0            # escape immediately leaves tmux

setw -g pane-border-style        $tm_color_inactive
setw -g pane-active-border-style $tm_color_active
set -g status-bg black
set -g status-fg white
set -g status-left ""
set -g status-right "#(. ~/.tmux/bar.sh)"

